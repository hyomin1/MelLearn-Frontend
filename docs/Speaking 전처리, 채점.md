# 채점 방법

## 1. 라이브러리를 사용하여 직접

### 1. 전처리

원본 가사와 유저의 녹음 텍스트의 형식을 일치시켜야함.

>> #### 1. text의 줄바꿈 형식을 lyric과 맞춤
>>
>>   일반적으로 한 문장은 대문자로 시작해서 온점으로 끝남. 하지만 대부분의 가사에서는 온점을 사용하지 않고 문장의 처음 시작이 대문자로 시작한다는 보장이 없음.
>>
>>   또한 영어에서 I는 항상 대문자임. 따라서 문장의 시작을 대문자로 판단할 수 없음.
>>   
>>   그리고 일본어의 경우는? 대문자로 시작하지도 않음. 그래서 이 방법으론 전처리가 불가능함.
>>
>>   음악을 lrc 포맷으로 받으면 문장의 시작이 나옴. 또한 whisper에서 변환한 텍스트도 lrc 형식으로 받을 수 있음.
>>   
>>   lrc 포맷의 시작시간으로 텍스트를 정렬하고 문장을 토큰화 해서 저장해놓으면 될듯.
>>
>>   -> 오류발생. lyric 1문장이 text 2문장으로 이뤄진 상황이 있음.
>>
>>   -> 해결 : 만약 lyric1이 text1,2로 분할될 경우엔 lyric 1 -> text 2/2 비교. 다음 lyric2와 시간차이가 오차값 내외라면 다음 lyric에 할당. 만약 아니라면 text 2/2는 lyric 1에 할당. (해결 방법만 적어놓음. 되는지는 해봐야함)

>>
>> #### 2. 특수문자 제거
>>    정규 표현식 사용.
>>   
>>   


### 2. 채점

전처리만 완벽하게 된다면 채점은 충분히 가능.
대부분의 상황에서 제대로 된 채점이 가능하지만, 가사의 특성상 예측할 수 없는 단어들이 나오기 때문에 특이 케이스들도 있음. 

케이스 생각해보기.

#### 1. 노래 가사에는 가창을 표시하려고 끝음을 길게 처리하는 단어가 있음.

e.g) Ohhhh (Lyric) -> Oh (Whisper)
이건 맞았다고 해줘야함. 해결 방법은 마지막에 같이 서술.

#### 2. Apple and Banana, Banana and Apple -> 순서가 달라도 맞았다고 됨.

이건 딜레마임.
채점을 하는 과정에서 한 문장의 단어들을 토큰화시켜서 순서와 상관없이 존재 유무로 채점함.
이렇게 하지 않고 순서대로 한 단어씩 채점한다면 단어의 개수가 달라졌을 때 채점이 불가능함.

때문에 이건 어쩔 수 없음. 어차피 이 경우는 희박할 것 같음.

#### 3. Whisper는 존재하는 단어를 기반으로 변환해줌.
만약 노래에서 사용하는 단어가 사전에 없는 단어라면 따라부른 텍스트도 이상할 것임.

해결 방법은 마지막에 같이 서술

#### 4. 한단어가 두 단어가 되어버리는 경우가 있음.

Daydream -> day dream
daydream을 빠르게 발음한다면 문제가 안되겠지만 노래의 특성상 daydream을 길게 발음한다면 day dream이 되어버림.

해결방법 아직 못찾았음.

#### 5. 수사의 경우 표현 방식이 두가지임.

만약 숫자 1을 표현한다면 1과 One으로 나뉘는데 이 때 불일치가 발생.
이건 가사마다 표현 방식이 달라서 수사는 빼고 채점.

1,3,5 번 해결방법 : 가사와 텍스트를 비교 시 채점 기준에서 제외되는 경우

- 1. 사전에 없는 단어는 틀려도 맞았다고 처리해줌.
     
사전에 없는 단어를 정확한 텍스트로 변환하기 힘듦
어차피 목적이 언어 공부이기 때문에 사전에 없는 단어는 채점 기준에서 제외.

- 2. 감탄사, 전치사, 수사인 경우에는 맞았다고 처리.
 
노래마다 표현 방식이 다르고 감탄사 전치사 수사는 굉장히 쉬운 단어의 범주에 속하기 때문에 채점에서 제외해도 채점 서비스에 미치는 지장은 미미하다고 판단.


## 2. GPT 모델에게 맡겨야함.

만약 1번 방식이 안된다면 gpt에게 맡겨야함.

